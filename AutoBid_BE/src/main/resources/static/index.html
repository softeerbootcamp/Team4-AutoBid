<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{auction.name}}</title>
</head>
<body>

<form id="btn" name="btn">
    <div class="form-group">
        <button type="submit">방만들기</button>
    </div>
</form>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<script>
    var btn = document.querySelector('#btn');

    var stompClient = null;
    console.log("data-b")

    btn.addEventListener('submit', connect, true)

    function connect(event){
        console.log("data-a")

        var socket = new SockJS("/auction-room");
        stompClient = Stomp.over(socket);
        stompClient.connect({}, onConnected);
        event.preventDefault();
    }

    function onConnected() {
        console.log("data1")
        var auctionRoomInfo = {
            auctionId: "1",
            username: "sungjun"
        };
        console.log("data2")
        stompClient.send("/publish/createRoom", {}, JSON.stringify(auctionRoomInfo));
        console.log("data3")

        // Subscribe to the Public Topic
        stompClient.subscribe('/subscribe/auction'); // 구독을 퍼블리쉬로 보낸다.

        // Tell your username to the server
        // stompClient.send("/publish/auction/createRoom",
        //     {},
        //     JSON.stringify({auctionId: "auctionRoomId", username: "user"})
        // )
    }

</script>

<!--<script src="main.js"></script>-->
</body>
</html>

